config:
  name: "Mass XSS Scanner"
  author: "Rikunj Sindhwad"
  usage: "./TaskNinja -w XSS_Scanner.yaml -v url_list=urls.txt"
  defaultimage: "alpine:latest"
  logs: false
vars:
  url_list: "" # Input List of URLS to scan
  header: "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36"
tasks:
  - name: dalfox
    silent: true
    parallel: false
    image: "robensive/dalfox:latest"
    type: dynamic
    dynamicFile: '{{url_list}}'
    threads: 5
    cmds:
      - url {{dynamicFile}} --deep-domxss --header "{{header}}" --format json --output {{hiveout}}/output.txt
  - name: Result
    silent: false
    parallel: false
    image: "robensive/jq:latest"
    mounts:
      - dalfox
    cmds:
      - cat {{{dalfox:folder}}}/*/out/output.txt | jq -r '.[] | [.type, .method, .data, .param, .payload, .evidence, .cwe, .severity] | @csv' | grep -v ',,,,,,,'  > {{hiveout}}/result.txt
      - echo Result Saved in "{{hosthiveout}}/result.txt"
