config:
  name: "Ultimate Subdomain Takeover"
  author: "Rikunj Sindhwad"
  usage: "./TaskNinja -w ultimateTakeover.yaml -v list=Subdomains.txt"
  defaultimage: "alpine:latest"
  logs: false
vars:
  list: "" # Input List of URLS to scan
  resolvers: "https://raw.githubusercontent.com/trickest/resolvers/main/resolvers.txt"
  centconfig: "https://gist.githubusercontent.com/nenadzaric/1c1ec7968867283b91e6cd9963bdfb8d/raw/fa18e93c88ec7ffd9e6e6d08da9c99a39ac90ded/.cent.yaml"
tasks:
  - name: dnsX
    image: "quay.io/trickest/dnsx:v1.1.6"
    silent: true
    parallel: false
    inputs:
      - "{{list}},input.txt"
      - "{{resolvers}},resolvers.txt"
    cmds: 
      - '-t 500 -rcode servfail,refused -ns -trace -r {{hivein}}/resolvers.txt -l {{hivein}}/input.txt -o {{hiveout}}/output.txt'
  - name: httpx
    image: "projectdiscovery/httpx:latest"
    silent: true
    parallel: true
    inputs:
      - "{{list}},input.txt"
    cmds:
      - '-l {{hivein}}/input.txt -threads 200  -timeout 10 -retries 2 -o {{hiveout}}/output.txt'
  - name: Cent-Templates
    silent: true
    parallel: false
    image: "quay.io/trickest/cent:1ebc728-patch-3"
    required:
      - dnsX
    inputs:
      - "{{centconfig}},cent.yaml"
    cmds:
      - '{{hivein}}/cent.yaml --threads 50 {{hiveout}}'
  - name: Takeover-Templates
    silent: true
    parallel: false
    required:
      - Cent-Templates
    mounts:
      - Cent-Templates
    cmds:
      - 'mv {{{Cent-Templates:folder}}}/out/*-takeover* {{hiveout}}/'
  - name: Nuclei
    silent: true
    parallel: true
    image: "projectdiscovery/nuclei:latest"
    required:
      - Takeover-Templates
      - httpx 
    mounts:
      - Takeover-Templates
      - httpx
    cmds:
      - '-l {{{httpx:file}}} -t {{{Takeover-Templates:Folder}}}/out -o {{hiveout}}/output.txt'
  - name: dnsreaper
    image: "quay.io/trickest/dnsreaper:dd7fa2a-patch-2"
    silent: true
    parallel: false
    inputs:
      - "{{list}},input.txt"
    cmds:
      - 'file --filename {{hivein}}/input.txt --parallelism 150 {{hiveout}}/output.txt'
  - name: Result
    silent: false
    parallel: false
    required:
      - dnsX
      - dnsreaper
      - Nuclei
    mounts:
      - dnsX
      - dnsreaper
      - Nuclei
    cmds:
      - 'mv {{{dnsreaper:file}}} {{hiveout}}/dnsreaper-result.txt'
      - 'echo dnsreaper result saved in {{hosthiveout}}/dnsreaper-result.txt'
      - 'mv {{{dnsX:file}}} {{hiveout}}/dnsx-result.txt'
      - 'echo dnsX result saved in {{hosthiveout}}/dnsx-result.txt'
      - 'mv {{{Nuclei:file}}} {{hiveout}}/nuclei-result.txt'
      - 'echo nuclei result saved in {{hosthiveout}}/nuclei-result.txt'
