config:
  name: "NucleiFuzzer"
  author: "Rikunj Sindhwad"
  usage: "./TaskNinja -w NucleiFuzzer.yaml -v target=example.com"
  logs: false
  defaultimage: "alpine:latest"
vars:
  target: ""
  blacklist: "swf,woff,woff2,eot,ttf,pngx,svg,gifx,ico,jpg,jpeg,gif,bmp,pdf,mp3,mp4,avi,csv,xls,xlsx,doc,docx,ppt,pptx,webp,png,css,js,xml,txt,exe,ts,tn,css"
  header: "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4585.0 Safari/537.36"

tasks:
  - name: Gau - Discovery
    silent: true
    parallel: true
    image: "robensive/gau:latest"
    cmds:
      - '{{target}}  --fp --retries 5 --threads 100 --blacklist {{blacklist}} {{hiveout}}/output.txt'
  - name: Katana - Crawling
    silent: true
    parallel: false
    image: "projectdiscovery/katana:latest"
    cmds:
      - '-u {{target}} -no-color -headers "{{header}}" -concurrency 100 -known-files all -extension-filter "{{blacklist}}" -output  {{hiveout}}/output.txt'
  - name: Merge Both
    silent: true
    parallel: false
    mounts:
      - Gau - Discovery
      - Katana - Crawling
    required: 
      - Gau - Discovery
      - Katana - Crawling

    cmds:
      - cat {{{Gau - Discovery:file}}} {{{Katana - Crawling:file}}} | sort -n | uniq | tee {{hiveout}}/output.txt
  - name: URLDedupe - Remove Duplicate URLS
    silent: true
    image: "robensive/urldedupe:latest"
    mounts:
      - Merge Both
    parallel: false
    cmds:
      - '-u {{{Merge Both:file}}} -s {{hiveout}}/output.txt'
  - name: Fuzzing Templates
    silent: true
    image: "bitnami/git:latest"
    parallel: false
    cmds:
      - git clone https://github.com/projectdiscovery/fuzzing-templates {{hiveout}}
  - name: Run Nuclei
    silent: false
    parallel: false
    image: "projectdiscovery/nuclei:latest"
    mounts:
      - URLDedupe - Remove Duplicate URLS
      - Fuzzing Templates
    required: 
      - Fuzzing Templates
      - URLDedupe - Remove Duplicate URLS
    cmds:
      - '-silent -t {{{Fuzzing Templates:folder}}} -l {{{URLDedupe - Remove Duplicate URLS:file}}} -o {{hiveout}}/output.txt'
  - name: Result
    silent: false
    parallel: false
    mounts:
      - Run Nuclei
    required: 
      - Run Nuclei
    cmds:
      - cp {{{Run Nuclei:file}}} {{hiveout}}/result.txt
      - echo Result Saved in {{hosthiveout}}/result.txt